# Переход на новую архитектуру

## Источники

* Сравниваем различные способы выполнения HTTP-запросов в JavaScript https://yandex.ru/turbo/nuancesprog.ru/s/p/7666/
* Куки, document.cookie https://learn.javascript.ru/cookie

* Use basic authentication with jQuery and Ajax https://stackoverflow.com/questions/5507234/use-basic-authentication-with-jquery-and-ajax
* AJAX and HTTP Basic Auth https://zinoui.com/blog/ajax-basic-authentication
* Примеры работы с AJAX. Отправка GET, POST, HEAD запросов через AJAX на javascript. https://javascript.ru/blog/gordon-freeman/primery-raboty-s-ajax-otpravka-get-post-head-zaprosov-cherez-ajax-javascript

* REST API — Что такое HATEOAS? https://m.habr.com/en/post/483328/
* вариант фреймвороков для python для клиентской части https://rapidapi.com/blog/best-python-api-frameworks/
* выбор python фреймворка: DJANGO или Flask https://python-scripts.com/flask-or-django#flask-vs-django-differences
* Babel как использовать с VSCode https://www.youtube.com/watch?v=VrayPysaeGY

* Var or Let https://www.it-rem.ru/javascript-raznitsa-mezhdu-var-i-let.html
* Nodejs https://nodejs.org/en/about/ (есть либа аксиос)

* SAMPLE server: Некоторое готовое решение https://github.com/sgangopadhyay/python-rest-api/blob/master/restapi.py
* SAMPLE server: CRUD приложение на Flask https://habr.com/en/company/skillbox/blog/464705/
* SAMPLE server: Python flask Postgresql https://eax.me/python-flask/ https://github.com/afiskon/py-flask-example
* SAMPLE server: Python flask https://habr.com/en/post/246699/
* SAMPLE server: https://www.youtube.com/watch?v=WxGBoY5iNXY
* SAMPLE server: https://www.codementor.io/@olawalealadeusi896/restful-api-with-python-flask-framework-and-postgres-db-part-1-kbrwbygx5

* SAMPLE client: https://blog.miguelgrinberg.com/post/writing-a-javascript-rest-client (VueJS vs React (макс советуешь использовать реакт), ангуляр говорит умер)

* Мертв ли PHP https://vc.ru/dev/90977-zhiv-li-php

* Mern stack https://habr.com/en/company/piter/blog/458096/
* Mongo https://www.mongodb.com

* Mongo или Postgres https://www.mongodb.com/compare/mongodb-postgresql
* Postgres vs Mongo / Олег Бартунов (Postgres Professional) https://www.youtube.com/watch?v=SNzOZKvFZ68

* SQLAlchemy https://coderlessons.com/tutorials/bazy-dannykh/sqlalchemy/sqlalchemy-kratkoe-rukovodstvo
* Flask w SQLAlchemy https://pythonru.com/biblioteki/sqlalchemy-v-flask

* Flask + Cookie https://pythonru.com/uroki/12-kuki-vo-flask

## Вопросы

* Как не дать скрипту гугл аналитики или другим интеграционным вещам доступ к кукам пользователя для авторизации на сайте?
* Etag или Cookie?
* Как ограничить запросы только с домена сайта (можно ли подтвержать это как-то с помощью серта)
* Какой метод для AJAX? Fetch?
* Какой REST API на Python выбрать? Flask, Django или вообще не python, а nodejs?

## Идея

После изучения темы пришел к выводу, что хочу сделать полностью кешируемое приложение (статичный сайт) с удаленным доступом к бекенду. Бек будет обновлять статику через тот же GitHub Pages.

Точкой входа будет `DOMAIN/APP/API/VERSION/RESOURCE`

* /auth – авторизация пользователей
  * Login: GET + Basic Auth => TOKEN (Digest)
    * Max retries
    * Session period
    * Blocked user
  * Logout: DELETE + TOKEN => OK
* /user – работа с пользователями
  * Me: GET + TOKEN => JSON
  * User info: GET + ID + TOKEN => JSON
  * List: GET + TOKEN => List
  * Add user: POST + JSON + TOKEN => OK
  * Delete user: DELETE + ID + TOKEN => OK
  * Modify user: PATCH + ID + JSON + TOKEN => OK
* /group – работа с группами
  * Group info: GET + ID + TOKEN => JSON
  * List: GET + TOKEN => List
  * Add group: POST + ID + TOKEN => OK
  * Delete group: DELETE + ID + TOKEN => OK
  * Modify user: PATCH + ID + JSON + TOKEN => OK
* /post – работа с постами

В качестве базы данных буду использовать https://hub.docker.com/_/postgres

Пример REST API https://www.youtube.com/watch?v=Gu2cWU58FI8

Были еще какие-то специальный токены запросов, чтобы работать асинхронно

## Необходимые зависимости

|Requirement|Description|Source|
|-|-|-|
|flask-restful|Flask-RESTful is an extension for Flask that adds support for quickly building REST APIs. It is a lightweight abstraction that works with your existing ORM/libraries. Flask-RESTful encourages best practices with minimal setup. If you are familiar with Flask, Flask-RESTful should be easy to pick up. https://flask-restful.readthedocs.io/en/latest/||
|flask-httpauth|авторизация Basic или Digest https://github.com/miguelgrinberg/flask-httpauth|https://habr.com/en/post/246699/|
|sqlalchemy|-|-|
|-|-|-|

## Тестирование

Для тестирования можно использовать Heroku или PwD
https://labs.play-with-docker.com/?stack=https://raw.githubusercontent.com/docker-library/docs/9efeec18b6b2ed232cf0fbd3914b6211e16e242c/postgres/stack.yml

## Запуск

https://flask.palletsprojects.com/en/1.1.x/installation/

```bash
cd myproject
python3 -m venv venv
. venv/bin/activate
```

SPA (Single page application)
CORF